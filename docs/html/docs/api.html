<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>API documentation &#8212; pypillometry  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/nature.css?v=279e0f84" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Developers" href="dev.html" />
    <link rel="prev" title="Example: Preprocessing of a full dataset with multiple subjects" href="preproc_example_pavlov.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dev.html" title="Developers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="preproc_example_pavlov.html" title="Example: Preprocessing of a full dataset with multiple subjects"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pypillometry  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">API documentation</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-pypillometry.pupildata">
<span id="api-documentation"></span><h1>API documentation<a class="headerlink" href="#module-pypillometry.pupildata" title="Link to this heading">¶</a></h1>
<section id="pupildata-py">
<h2>pupildata.py<a class="headerlink" href="#pupildata-py" title="Link to this heading">¶</a></h2>
<p>Main object-oriented entry point</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="pypillometry.pupildata.FakePupilData">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pypillometry.pupildata.</span></span><span class="sig-name descname"><span class="pre">FakePupilData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pupil</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_onsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real_baseline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real_response_coef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.FakePupilData" title="Link to this definition">¶</a></dt>
<dd><p>Simulated pupil data for validation purposes.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.FakePupilData.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pupil</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_onsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real_baseline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real_response_coef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.FakePupilData.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Constructor for artifical pupil data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.FakePupilData.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-inf,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simulated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sec'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.FakePupilData.plot" title="Link to this definition">¶</a></dt>
<dd><p>Make a plot of the pupil data using <cite>matplotlib</cite> or <a class="reference internal" href="#pypillometry.convenience.plot_pupil_ipy" title="pypillometry.convenience.plot_pupil_ipy"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.convenience.plot_pupil_ipy()</span></code></a>
if <cite>interactive=True</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_range</strong> (tuple (start,end): plot from start to end (in units of <cite>units</cite>))</p></li>
<li><p><strong>baseline</strong> (<em>plot baseline if estimated</em>)</p></li>
<li><p><strong>response</strong> (<em>plot response if estimated</em>)</p></li>
<li><p><strong>model</strong> (<em>plot full model if baseline and response have been estimated</em>)</p></li>
<li><p><strong>simulated</strong> (<em>plot also the &quot;ground-truth&quot; baseline and response</em><em> (</em><em>i.e.</em><em>, </em><em>the simulated one</em><em>)</em><em>?</em>)</p></li>
<li><p><strong>interactive</strong> (<em>if True</em><em>, </em><em>plot with sliders to adjust range</em>)</p></li>
<li><p><strong>units</strong> (<em>one</em><em> of </em><em>&quot;sec&quot;=seconds</em><em>, </em><em>&quot;ms&quot;=millisec</em><em>, </em><em>&quot;min&quot;=minutes</em><em>, </em><em>&quot;h&quot;=hours</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.FakePupilData.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.FakePupilData.scale" title="Link to this definition">¶</a></dt>
<dd><p>Scale the pupillary signal by subtracting <cite>mean</cite> and dividing by <cite>sd</cite>.
If these variables are not provided, use the signal’s mean and std.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<em>mean to subtract from signal</em>)</p></li>
<li><p><strong>sd</strong> (<em>sd to scale with</em>)</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Scaling-parameters are being saved in the <cite>scale_params</cite> argument.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.FakePupilData.sub_slice">
<span class="sig-name descname"><span class="pre">sub_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sec'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.FakePupilData.sub_slice" title="Link to this definition">¶</a></dt>
<dd><p>Return a new <cite>PupilData</cite> object that is a shortened version
of the current one (contains all data between <cite>start</cite> and
<cite>end</cite> in units given by <cite>units</cite> (one of “ms”, “sec”, “min”, “h”).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.FakePupilData.unscale">
<span class="sig-name descname"><span class="pre">unscale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.FakePupilData.unscale" title="Link to this definition">¶</a></dt>
<dd><p>Scale back to original values using either values provided as arguments
or the values stored in <cite>scale_params</cite>.n</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<em>mean to add from signal</em>)</p></li>
<li><p><strong>sd</strong> (<em>sd to scale with</em>)</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pypillometry.pupildata.</span></span><span class="sig-name descname"><span class="pre">PupilData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pupil</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_onsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_orig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_time_discontinuities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData" title="Link to this definition">¶</a></dt>
<dd><p>Class representing pupillometric data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pupil</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_onsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_orig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_time_discontinuities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – name of the dataset or <cite>None</cite> (in which case a random string is selected)</p></li>
<li><p><strong>time</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>) – timing array or <cite>None</cite>, in which case the time-array goes from [0,maxT]
using <cite>sampling_rate</cite> (in ms)</p></li>
<li><p><strong>pupil</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]]</span>) – pupillary data at times <cite>time</cite> assumed to be in ms</p></li>
<li><p><strong>event_onsets</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>) – time-onsets of any events that are to be modelled in the pupil</p></li>
<li><p><strong>event_labels</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>) – for each event in <cite>event_onsets</cite>, provide a label</p></li>
<li><p><strong>sampling_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling-rate of the pupillary signal in Hz</p></li>
<li><p><strong>keep_orig</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – keep a copy of the original dataset? If <cite>True</cite>, a copy of the <a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a> object
as initiated in the constructor is stored in member <cite>PupilData.original</cite></p></li>
<li><p><strong>fill_time_discontinuities</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – sometimes, when the eyetracker loses signal, no entry in the EDF is made;
when this option is True, such entries will be made and the signal set to 0 there</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.__len__" title="Link to this definition">¶</a></dt>
<dd><p>Return number of sampling points in the pupil data.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.__repr__" title="Link to this definition">¶</a></dt>
<dd><p>Return a string-representation of the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#pypillometry.pupildata.PupilData.__weakref__" title="Link to this definition">¶</a></dt>
<dd><p>list of weak references to the object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.add_to_history">
<span class="sig-name descname"><span class="pre">add_to_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.add_to_history" title="Link to this definition">¶</a></dt>
<dd><p>Add event to history</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.apply_history">
<span class="sig-name descname"><span class="pre">apply_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.apply_history" title="Link to this definition">¶</a></dt>
<dd><p>Apply history of operations done on <cite>self</cite> to <cite>obj</cite>.</p>
<section id="parameters">
<h2>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>obj: <a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a></dt><dd><p>object of class <a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a> to which the operations are to be transferred</p>
</dd>
</dl>
</section>
<section id="returns">
<h2>Returns:<a class="headerlink" href="#returns" title="Link to this heading">¶</a></h2>
<p>:</p>
<p>copy of the <a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a>-object to which the operations in <cite>self</cite> were applied</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.blinks_detect">
<span class="sig-name descname"><span class="pre">blinks_detect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blink_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">winsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel_onset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_onset_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_offset_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['zero',</span> <span class="pre">'velocity']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ms'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.blinks_detect" title="Link to this definition">¶</a></dt>
<dd><p>Detect blinks in the pupillary signal using several strategies.
First, blinks are detected as consecutive sequence of <cite>blink_val</cite>
(f.eks., 0 or NaN). Second, blinks are defined as everything between
two crossings of the velocity profile (from negative to positive).</p>
<p>Detected blinks are put into member <cite>blinks</cite> (matrix 2 x nblinks where start and end
are stored as indexes) and member <cite>blink_mask</cite> which codes for each sampling point
whether there is a blink (1) or not (0).</p>
<p>Finally, detected blinks have to be at least <cite>min_duration</cite> duration (in <cite>units</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – minimum duration for a sequence of missing numbers to be treated as blink</p></li>
<li><p><strong>blink_val</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – “missing value” code</p></li>
<li><p><strong>winsize</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – window-size for smoothing for velocity profile (in units)</p></li>
<li><p><strong>vel_onset</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – negative velocity that needs to be crossed; arbitrary units that depend on
sampling rate etc</p></li>
<li><p><strong>vel_offset</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – positive velocity that needs to be exceeded; arbitrary units that depend on
sampling rate etc</p></li>
<li><p><strong>min_onset_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – minimum number of consecutive samples that crossed threshold in the velocity
profile to detect as onset (to avoid noise-induced changes)</p></li>
<li><p><strong>min_offset_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – minimum number of consecutive samples that crossed threshold in the velocity
profile to detect as offset (to avoid noise-induced changes)</p></li>
<li><p><strong>strategies</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><em>strategies to use</em>) – so far, use a list containing any combination of “zero” and “velocity”</p></li>
<li><p><strong>units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – one of “ms”, “sec”, “min”, “h”</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.blinks_interp_mahot">
<span class="sig-name descname"><span class="pre">blinks_interp_mahot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">winsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel_onset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">margin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">30)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blinkwindow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cubic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(5,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.blinks_interp_mahot" title="Link to this definition">¶</a></dt>
<dd><p>Implements the blink-interpolation method by Mahot (2013).</p>
<p>Mahot, 2013:
<a class="reference external" href="https://figshare.com/articles/A_simple_way_to_reconstruct_pupil_size_during_eye_blinks/688001">https://figshare.com/articles/A_simple_way_to_reconstruct_pupil_size_during_eye_blinks/688001</a>.</p>
<p>This procedure relies heavily on eye-balling (reconstructing visually convincing signal),
so a “plot” option is provided that will plot many diagnostics (see paper linked above) that
can help to set good parameter values for <cite>winsize</cite>, <cite>vel_onset</cite>, <cite>vel_offset</cite> and <cite>margin</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>winsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – size of the Hanning-window in ms</p></li>
<li><p><strong>vel_onset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – velocity-threshold to detect the onset of the blink</p></li>
<li><p><strong>vel_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – velocity-threshold to detect the offset of the blink</p></li>
<li><p><strong>margin</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>]</em>) – margin that is subtracted/added to onset and offset (in ms)</p></li>
<li><p><strong>blinkwindow</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – how much time before and after each blink to include (in ms)</p></li>
<li><p><strong>interp_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – type of interpolation accepted by <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.interpolate.interp1d()</span></code></p></li>
<li><p><strong>plot</strong> (<em>True</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>None</em>) – if a string, the plot is going to be saved to a multipage PDF file;
if None, no plotting is done
if True, plot is not saved but produced</p></li>
<li><p><strong>plot_dim</strong> (<em>tuple nrow x ncol</em>) – number of subplots</p></li>
<li><p><strong>plot_figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> (</em><em>width</em><em>, </em><em>height</em><em>)</em>) – dimensions for each figure</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.blinks_interpolate">
<span class="sig-name descname"><span class="pre">blinks_interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">winsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel_onset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">margin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">30)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cubic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.blinks_interpolate" title="Link to this definition">¶</a></dt>
<dd><p>Interpolation of missing data “in one go”.
Detection of blinks happens using Mahot (2013), see <a class="reference internal" href="#pypillometry.preproc.blink_onsets_mahot" title="pypillometry.preproc.blink_onsets_mahot"><code class="xref py py-func docutils literal notranslate"><span class="pre">blink_onsets_mahot()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>winsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – size of the Hanning-window in ms</p></li>
<li><p><strong>vel_onset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – velocity-threshold to detect the onset of the blink</p></li>
<li><p><strong>vel_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – velocity-threshold to detect the offset of the blink</p></li>
<li><p><strong>margin</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>]</em>) – margin that is subtracted/added to onset and offset (in ms)</p></li>
<li><p><strong>interp_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – type of interpolation accepted by <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.interpolate.interp1d()</span></code></p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.blinks_merge">
<span class="sig-name descname"><span class="pre">blinks_merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_signal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.blinks_merge" title="Link to this definition">¶</a></dt>
<dd><p>Merge together blinks that are close together.
Some subjects blink repeatedly and standard detection/interpolation can result in weird results.
This function simply treats repeated blinks as one long blink.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – merge together blinks that are closer together than <cite>distance</cite> in ms</p></li>
<li><p><strong>remove_signal</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if True, set all signal values during the “new blinks” to zero so
that <code class="xref py py-func docutils literal notranslate"><span class="pre">detect_blinks()</span></code> will pick them up; interpolation will work
either way</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.blinks_plot">
<span class="sig-name descname"><span class="pre">blinks_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_blink</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_blink</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ms'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.blinks_plot" title="Link to this definition">¶</a></dt>
<dd><p>Plot the detected blinks into separate figures each with nrow x ncol subplots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdf_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>None</em>) – if the name of a file is given, the figures are saved into a multi-page PDF file</p></li>
<li><p><strong>ncol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of columns for the blink-plots</p></li>
<li><p><strong>pre_blink</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – extend plot a certain time before each blink (in ms)</p></li>
<li><p><strong>post_blink</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – extend plot a certain time after each blink (in ms)</p></li>
<li><p><strong>units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – units in which the signal is plotted</p></li>
<li><p><strong>plot_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – plot a number with the blinks’ index (e.g., for identifying abnormal blinks)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li></li>
<li><p><em>list of plt.Figure objects each with nrow*ncol subplots</em></p></li>
<li><p><em>in Jupyter Notebook, those are displayed inline one after the other</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.copy" title="Link to this definition">¶</a></dt>
<dd><p>Make and return a deep-copy of the pupil data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.downsample">
<span class="sig-name descname"><span class="pre">downsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fsd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsfac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.downsample" title="Link to this definition">¶</a></dt>
<dd><p>Simple downsampling scheme using mean within the downsampling window.
See <a class="reference internal" href="#pypillometry.baseline.downsample" title="pypillometry.baseline.downsample"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.baseline.downsample()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fsd</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – new sampling-rate or decimate-factor</p></li>
<li><p><strong>dsfac</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – if False, <cite>fsd</cite> is the new sampling rate;
if True, <cite>fsd</cite> is the decimate factor</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.drop_original">
<span class="sig-name descname"><span class="pre">drop_original</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.drop_original" title="Link to this definition">¶</a></dt>
<dd><p>Drop original dataset from record (e.g., to save space).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.estimate_baseline">
<span class="sig-name descname"><span class="pre">estimate_baseline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'envelope_iter_bspline_2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.estimate_baseline" title="Link to this definition">¶</a></dt>
<dd><p>Apply one of the baseline-estimation methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – <dl class="simple">
<dt>“envelope_iter_bspline_1”: <a class="reference internal" href="#pypillometry.baseline.baseline_envelope_iter_bspline" title="pypillometry.baseline.baseline_envelope_iter_bspline"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.baseline.baseline_envelope_iter_bspline()</span></code></a></dt><dd><p>with one iteration</p>
</dd>
<dt>”envelope_iter_bspline_2”: <a class="reference internal" href="#pypillometry.baseline.baseline_envelope_iter_bspline" title="pypillometry.baseline.baseline_envelope_iter_bspline"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.baseline.baseline_envelope_iter_bspline()</span></code></a></dt><dd><p>with two iterations</p>
</dd>
</dl>
</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
<li><p><strong>kwargs</strong> – named arguments passed to the low-level function in <a class="reference internal" href="#module-pypillometry.baseline" title="pypillometry.baseline"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pypillometry.baseline</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the results of the estimation is stored in member <cite>baseline</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.estimate_response">
<span class="sig-name descname"><span class="pre">estimate_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'free'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'free'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'npar':</span> <span class="pre">(1,</span> <span class="pre">20),</span> <span class="pre">'tmax':</span> <span class="pre">(100,</span> <span class="pre">2000)}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.estimate_response" title="Link to this definition">¶</a></dt>
<dd><p>Estimate pupil-response based on event-onsets, see
<a class="reference internal" href="#pypillometry.pupil.pupil_response" title="pypillometry.pupil.pupil_response"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.pupil.pupil_response()</span></code></a>.</p>
<dl class="simple">
<dt>npar: float</dt><dd><p>npar-parameter for the canonical response-function or “free”;
in case of “free”, the function optimizes for this parameter</p>
</dd>
<dt>tmax: float</dt><dd><p>tmax-parameter for the canonical response-function or “free”;
in case of “free”, the function optimizes for this parameter</p>
</dd>
<dt>bounds: dict</dt><dd><p>in case that one or both parameters are estimated, give the lower
and upper bounds for the parameters</p>
</dd>
<dt>inplace: bool</dt><dd><p>if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the results of the estimation is stored in members <cite>response</cite>, <cite>response_x</cite> (design matrix)
and <cite>response_pars</cite></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.from_file">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.from_file" title="Link to this definition">¶</a></dt>
<dd><p>Reads a <a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a> object from a pickle-file.
Use as <code class="docutils literal notranslate"><span class="pre">pypillometry.PupilData.from_file(&quot;yourfile.pd&quot;)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – filename</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.get_erpd">
<span class="sig-name descname"><span class="pre">get_erpd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">erpd_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_select</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_win</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_win</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-500,</span> <span class="pre">2000)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.get_erpd" title="Link to this definition">¶</a></dt>
<dd><p>Extract event-related pupil dilation (ERPD).
No attempt is being made to exclude overlaps of the time-windows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>erpd_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – identifier for the result (e.g., “cue-locked” or “conflict-trials”)</p></li>
<li><p><strong>baseline_win</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>) or </em><em>None</em>) – <p>if None, no baseline-correction is applied
if tuple, the mean value in the window in milliseconds (relative to <cite>time_win</cite>) is</p>
<blockquote>
<div><p>subtracted from the single-trial ERPDs (baseline-correction)</p>
</div></blockquote>
</p></li>
<li><p><strong>event_select</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>function</em>) – variable describing which events to select and align to
- if str: use all events whose label contains the string
- if function: apply function to all labels, use those where the function returns True</p></li>
<li><p><strong>time_win</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>]</em>) – time before and after event to include (in ms)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.lowpass_filter">
<span class="sig-name descname"><span class="pre">lowpass_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.lowpass_filter" title="Link to this definition">¶</a></dt>
<dd><p>Lowpass-filter signal using a Butterworth-filter,
see <a class="reference internal" href="#pypillometry.baseline.butter_lowpass_filter" title="pypillometry.baseline.butter_lowpass_filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.baseline.butter_lowpass_filter()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – lowpass-filter cutoff</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – filter order</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.nblinks">
<span class="sig-name descname"><span class="pre">nblinks</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.nblinks" title="Link to this definition">¶</a></dt>
<dd><p>Return number of detected blinks. Should be run after <cite>detect_blinks()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.nevents">
<span class="sig-name descname"><span class="pre">nevents</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.nevents" title="Link to this definition">¶</a></dt>
<dd><p>Return number of events in pupillometric data.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-inf,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlight_blinks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlight_interpolated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sec'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.plot" title="Link to this definition">¶</a></dt>
<dd><p>Make a plot of the pupil data using <cite>matplotlib</cite> or <a class="reference internal" href="#pypillometry.convenience.plot_pupil_ipy" title="pypillometry.convenience.plot_pupil_ipy"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.convenience.plot_pupil_ipy()</span></code></a>
if <cite>interactive=True</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> (</em><em>start</em><em>,</em><em>end</em><em>)</em>) – plot from start to end (in units of <cite>units</cite>)</p></li>
<li><p><strong>baseline</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – plot baseline if estimated</p></li>
<li><p><strong>response</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – plot response if estimated</p></li>
<li><p><strong>model</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – plot full model if baseline and response have been estimated</p></li>
<li><p><strong>interactive</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if True, plot with sliders to adjust range</p></li>
<li><p><strong>units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – one of “sec”=seconds, “ms”=millisec, “min”=minutes, “h”=hours</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.plot_segments">
<span class="sig-name descname"><span class="pre">plot_segments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdffile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(15,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.plot_segments" title="Link to this definition">¶</a></dt>
<dd><p>Plot the whole dataset chunked up into segments (usually to a PDF file).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdffile</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>None</em>) – file name to store the PDF; if None, no PDF is written</p></li>
<li><p><strong>interv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – duration of each of the segments to be plotted (in minutes)</p></li>
<li><p><strong>figsize</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em>) – dimensions of the figures</p></li>
<li><p><strong>kwargs</strong> – arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">PupilData.plot()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li></li>
<li><p><strong>figs</strong> (list of <code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.Figure</span></code> objects)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.print_history">
<span class="sig-name descname"><span class="pre">print_history</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.print_history" title="Link to this definition">¶</a></dt>
<dd><p>Pretty-print the history of the current dataset (which manipulations where done on it).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.reset_time">
<span class="sig-name descname"><span class="pre">reset_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.reset_time" title="Link to this definition">¶</a></dt>
<dd><p>Resets time so that the time-array starts at time zero (t0).
Resets onsets etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – time at which the <a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a>’s time-vector starts</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.scale" title="Link to this definition">¶</a></dt>
<dd><p>Scale the pupillary signal by subtracting <cite>mean</cite> and dividing by <cite>sd</cite>.
If these variables are not provided, use the signal’s mean and std.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – mean to subtract from signal</p></li>
<li><p><strong>sd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sd to scale with</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Scaling-parameters are being saved in the <cite>scale_params</cite> argument.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.size_bytes">
<span class="sig-name descname"><span class="pre">size_bytes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.size_bytes" title="Link to this definition">¶</a></dt>
<dd><p>Return size of current dataset in bytes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.smooth_window">
<span class="sig-name descname"><span class="pre">smooth_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hanning'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">winsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.smooth_window" title="Link to this definition">¶</a></dt>
<dd><p>Apply smoothing of the signal using a moving window. See <a class="reference internal" href="#pypillometry.preproc.smooth_window" title="pypillometry.preproc.smooth_window"><code class="xref py py-func docutils literal notranslate"><span class="pre">smooth_window()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>window</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <dl class="simple">
<dt>(the type of window from ‘flat’, ‘hanning’, ‘hamming’, ‘bartlett’, ‘blackman’);</dt><dd><p>flat window will produce a moving average smoothing.</p>
</dd>
</dl>
</p></li>
<li><p><strong>winsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – the length of the window in ms</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.stat_per_event">
<span class="sig-name descname"><span class="pre">stat_per_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_select=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statfct=&lt;function</span> <span class="pre">mean&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_missing=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.stat_per_event" title="Link to this definition">¶</a></dt>
<dd><p>Return result of applying a statistical function to pupillometric data in a
given interval relative to event-onsets. For example, extract mean
pupil-size in interval before trial onset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event_select</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>function</em>) – variable describing which events to select and align to
- if str: use all events whose label contains the string
- if function: apply function to all labels, use those where the function returns True</p></li>
<li><p><strong>interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> (</em><em>min</em><em>,</em><em>max</em><em>)</em>) – time-window in ms relative to event-onset (0 is event-onset)</p></li>
<li><p><strong>statfct</strong> (<em>function</em>) – function mapping np.array to a single number</p></li>
<li><p><strong>return_missing</strong> (<em>None</em><em>, </em><em>&quot;nmiss&quot;</em><em>, </em><em>&quot;prop&quot;</em>) – if None, only an array with the stats per event is return
if “nmiss”, returns a tuple (stat, nmiss) where <cite>nmiss</cite> is the number of missing vales in the timewin
if “prop”, return a tuple (stat, prop_miss) where <cite>prop_miss</cite> is the proportion missing vales in the timewin</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li></li>
<li><p><strong>result</strong> (<em>np.array</em>) – number of event-onsets long result array</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.sub_slice">
<span class="sig-name descname"><span class="pre">sub_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sec'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.sub_slice" title="Link to this definition">¶</a></dt>
<dd><p>Return a new <cite>PupilData</cite> object that is a shortened version
of the current one (contains all data between <cite>start</cite> and
<cite>end</cite> in units given by <cite>units</cite> (one of “ms”, “sec”, “min”, “h”).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – start for new dataset</p></li>
<li><p><strong>end</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – end of new dataset</p></li>
<li><p><strong>units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – time units in which <cite>start</cite> and <cite>end</cite> are provided</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.summary" title="Link to this definition">¶</a></dt>
<dd><p>Return a summary of the <a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a>-object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.unscale">
<span class="sig-name descname"><span class="pre">unscale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.unscale" title="Link to this definition">¶</a></dt>
<dd><p>Scale back to original values using either values provided as arguments
or the values stored in <cite>scale_params</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – mean to add from signal</p></li>
<li><p><strong>sd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sd to scale with</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.pupildata.PupilData.write_file">
<span class="sig-name descname"><span class="pre">write_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.write_file" title="Link to this definition">¶</a></dt>
<dd><p>Save to file (using <a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – filename</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.pupildata.create_fake_pupildata">
<span class="sig-prename descclassname"><span class="pre">pypillometry.pupildata.</span></span><span class="sig-name descname"><span class="pre">create_fake_pupildata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.create_fake_pupildata" title="Link to this definition">¶</a></dt>
<dd><p>Return a <code class="xref py py-class docutils literal notranslate"><span class="pre">pyillometry.pupildata.FakePupilData</span></code> object by buildling it with
<a class="reference internal" href="#pypillometry.fakedata.get_dataset" title="pypillometry.fakedata.get_dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.fakedata.get_dataset()</span></code></a>.</p>
<p>:param Same parameters as <a class="reference internal" href="#pypillometry.fakedata.get_dataset" title="pypillometry.fakedata.get_dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.fakedata.get_dataset()</span></code></a>.:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.pupildata.plotpd">
<span class="sig-prename descclassname"><span class="pre">pypillometry.pupildata.</span></span><span class="sig-name descname"><span class="pre">plotpd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.plotpd" title="Link to this definition">¶</a></dt>
<dd><p>Plotting for <cite>PupilData</cite> objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>subplots</strong> (plot the different <cite>PupilData</cite>-objects in the same plot or subplots)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.pupildata.plotpd_ia">
<span class="sig-prename descclassname"><span class="pre">pypillometry.pupildata.</span></span><span class="sig-name descname"><span class="pre">plotpd_ia</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(16,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">events</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.plotpd_ia" title="Link to this definition">¶</a></dt>
<dd><p>Interactive plotting for multiple <cite>PupilData</cite> objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<cite>PupilData</cite> datasets to plot)</p></li>
<li><p><strong>figsize</strong> (<em>dimensions</em><em> of </em><em>the plot</em>)</p></li>
<li><p><strong>baseline</strong> (<em>plot baselines</em><em>, </em><em>too?</em>)</p></li>
<li><p><strong>events</strong> (plot event-markers? if None, no events are plotted, otherwise <cite>events</cite>) – is the index of the <cite>PupilData</cite> object to take the events from</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<section id="erpd-py">
<span id="module-pypillometry.erpd"></span><h2>erpd.py<a class="headerlink" href="#erpd-py" title="Link to this heading">¶</a></h2>
<p>Event-related pupil dilation.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="pypillometry.erpd.ERPD">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pypillometry.erpd.</span></span><span class="sig-name descname"><span class="pre">ERPD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erpd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baselines</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.erpd.ERPD" title="Link to this definition">¶</a></dt>
<dd><p>Class representing a event-related pupillary dilation (ERPD) for one subject.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.erpd.ERPD.from_file">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.erpd.ERPD.from_file" title="Link to this definition">¶</a></dt>
<dd><p>Reads a <a class="reference internal" href="#pypillometry.erpd.ERPD" title="pypillometry.erpd.ERPD"><code class="xref py py-class docutils literal notranslate"><span class="pre">ERPD</span></code></a> object from a pickle-file.
Use as <code class="docutils literal notranslate"><span class="pre">pypillometry.ERPD.from_file(&quot;yourfile.pd&quot;)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – filename</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.erpd.ERPD.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">overlays=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meanfct=&lt;function</span> <span class="pre">mean&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varfct=&lt;function</span> <span class="pre">sem&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_missing=True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.erpd.ERPD.plot" title="Link to this definition">¶</a></dt>
<dd><p>Plot mean and error-ribbons using <cite>varct</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>overlays</strong> (single or sequence of <code class="xref py py-class docutils literal notranslate"><span class="pre">ERPDSingleSubject</span></code>-objects) – the overlays will be added to the same plot</p></li>
<li><p><strong>meanfct</strong> (<em>callable</em>) – mean-function to apply to the single-trial ERPDs for plotting</p></li>
<li><p><strong>varfct</strong> (<em>callable</em><em> or </em><em>None</em>) – function to calculate error-bands (e.g., <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.std.html#numpy.std" title="(in NumPy v2.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.std()</span></code></a> for standard-deviation
or <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.sem.html#scipy.stats.sem" title="(in SciPy v1.15.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.stats.sem()</span></code></a> for standard-error)
if None, no error bands are plotted</p></li>
<li><p><strong>plot_missing</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – plot percentage interpolated/missing data per time-point?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.erpd.ERPD.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.erpd.ERPD.summary" title="Link to this definition">¶</a></dt>
<dd><p>Return a summary of the <a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a>-object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pypillometry.erpd.ERPD.write_file">
<span class="sig-name descname"><span class="pre">write_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.erpd.ERPD.write_file" title="Link to this definition">¶</a></dt>
<dd><p>Save to file (using <a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – filename</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.erpd.group_erpd">
<span class="sig-prename descclassname"><span class="pre">pypillometry.erpd.</span></span><span class="sig-name descname"><span class="pre">group_erpd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datasets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">erpd_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_select</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_win=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_win=(-500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">2000)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subj_meanfct=&lt;function</span> <span class="pre">mean&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.erpd.group_erpd" title="Link to this definition">¶</a></dt>
<dd><p>Calculate group-level ERPDs by applying <cite>subj_meanfct</cite> to each subj-level ERPD.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datasets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><em>PupilData objects</em>) – one PupilData object for each subject that should go into the group-level ERPD.</p></li>
<li><p><strong>erpd_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – identifier for the result (e.g., “cue-locked” or “conflict-trials”)</p></li>
<li><p><strong>baseline_win</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>) or </em><em>None</em>) – <p>if None, no baseline-correction is applied
if tuple, the mean value in the window in milliseconds (relative to <cite>time_win</cite>) is</p>
<blockquote>
<div><p>subtracted from the single-trial ERPDs (baseline-correction)</p>
</div></blockquote>
</p></li>
<li><p><strong>event_select</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>function</em>) – variable describing which events to select and align to
- if str: use all events whose label contains the string
- if function: apply function to all labels, use those where the function returns True</p></li>
<li><p><strong>time_win</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>]</em>) – time before and after event to include (in ms)</p></li>
<li><p><strong>subj_meanfct</strong> (<em>fct</em>) – function to summarize each individual ERPD</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li></li>
<li><p>an <a class="reference internal" href="#pypillometry.erpd.ERPD" title="pypillometry.erpd.ERPD"><code class="xref py py-class docutils literal notranslate"><span class="pre">ERPD</span></code></a> object for the group</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.erpd.plot_erpds">
<span class="sig-prename descclassname"><span class="pre">pypillometry.erpd.</span></span><span class="sig-name descname"><span class="pre">plot_erpds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">erpds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.erpd.plot_erpds" title="Link to this definition">¶</a></dt>
<dd><p>Plot a list of ERPD objects.</p>
</dd></dl>

<section id="io-py">
<span id="module-pypillometry.io"></span><h2>io.py<a class="headerlink" href="#io-py" title="Link to this heading">¶</a></h2>
<p>Read/Write data from/to disk.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.io.pd_read_pickle">
<span class="sig-prename descclassname"><span class="pre">pypillometry.io.</span></span><span class="sig-name descname"><span class="pre">pd_read_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.io.pd_read_pickle" title="Link to this definition">¶</a></dt>
<dd><p>Read the <a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a>-object <cite>pdobj</cite> from file using <a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – filename or URL to load data from</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li></li>
<li><p><strong>pdobj</strong> (<a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a>) – loaded dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.io.pd_write_pickle">
<span class="sig-prename descclassname"><span class="pre">pypillometry.io.</span></span><span class="sig-name descname"><span class="pre">pd_write_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdobj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.io.pd_write_pickle" title="Link to this definition">¶</a></dt>
<dd><p>Store the <a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a>-object <cite>pdobj</cite> in file using <a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdobj</strong> (<a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a>) – dataset to save</p></li>
<li><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – filename to save to</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<section id="preproc-py">
<span id="module-pypillometry.preproc"></span><h2>preproc.py<a class="headerlink" href="#preproc-py" title="Link to this heading">¶</a></h2>
<p>preprocessing functions (blinks, smoothing, missing data…)</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.preproc.blink_onsets_mahot">
<span class="sig-prename descclassname"><span class="pre">pypillometry.preproc.</span></span><span class="sig-name descname"><span class="pre">blink_onsets_mahot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blinks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_winsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel_onset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel_offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">margin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blinkwindow</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.preproc.blink_onsets_mahot" title="Link to this definition">¶</a></dt>
<dd><p>Method for finding the on- and offset for each blink (excluding transient).
See <a class="reference external" href="https://figshare.com/articles/A_simple_way_to_reconstruct_pupil_size_during_eye_blinks/688001">https://figshare.com/articles/A_simple_way_to_reconstruct_pupil_size_during_eye_blinks/688001</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sy</strong> (<em>np.array</em>) – pupil data</p></li>
<li><p><strong>blinks</strong> (<em>np.array</em><em> (</em><em>nblinks x 2</em><em>)</em>) – blink onset/offset matrix (contiguous zeros)</p></li>
<li><p><strong>smooth_winsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> (</em><em>odd</em><em>)</em>) – size of the Hanning-window in sampling points</p></li>
<li><p><strong>vel_onset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – velocity-threshold to detect the onset of the blink</p></li>
<li><p><strong>vel_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – velocity-threshold to detect the offset of the blink</p></li>
<li><p><strong>margin</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>)</em>) – margin that is subtracted/added to onset and offset (in sampling points)</p></li>
<li><p><strong>blinkwindow</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – how much time before and after each blink to include (in sampling points)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.preproc.detect_blinks_velocity">
<span class="sig-prename descclassname"><span class="pre">pypillometry.preproc.</span></span><span class="sig-name descname"><span class="pre">detect_blinks_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_winsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel_onset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel_offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_onset_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_offset_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.preproc.detect_blinks_velocity" title="Link to this definition">¶</a></dt>
<dd><p>Detect blinks as everything between a fast downward and a fast upward-trending PD-changes.</p>
<p>This works similarly to <a class="reference internal" href="#pypillometry.preproc.blink_onsets_mahot" title="pypillometry.preproc.blink_onsets_mahot"><code class="xref py py-func docutils literal notranslate"><span class="pre">blink_onsets_mahot()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sy</strong> (<em>np.array</em>) – pupil data</p></li>
<li><p><strong>smooth_winsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> (</em><em>odd</em><em>)</em>) – size of the Hanning-window in sampling points</p></li>
<li><p><strong>vel_onset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – velocity-threshold to detect the onset of the blink</p></li>
<li><p><strong>vel_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – velocity-threshold to detect the offset of the blink</p></li>
<li><p><strong>min_onset_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – minimum number of consecutive samples that cross the threshold to detect onset</p></li>
<li><p><strong>min_offset_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – minimum number of consecutive samples that cross the threshold to detect offset</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.preproc.detect_blinks_zero">
<span class="sig-prename descclassname"><span class="pre">pypillometry.preproc.</span></span><span class="sig-name descname"><span class="pre">detect_blinks_zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blink_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.preproc.detect_blinks_zero" title="Link to this definition">¶</a></dt>
<dd><p>Detect blinks as consecutive sequence of <cite>blink_val</cite> (f.eks., 0 or NaN) of at least
<cite>min_duration</cite> successive values in the signal <cite>sy</cite>.
Detected blinks are put a matrix <cite>blinks</cite> (nblinks x 2) where start and end
are stored as indexes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sy</strong> (<em>np.array</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>)</em>) – signal</p></li>
<li><p><strong>min_duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – minimum number of consecutive samples for a sequence of missing numbers to be treated as blink</p></li>
<li><p><strong>blink_val</strong> – “missing value” code</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.array (nblinks x 2) containing the indices of the start/end of the blinks</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.preproc.smooth_window">
<span class="sig-prename descclassname"><span class="pre">pypillometry.preproc.</span></span><span class="sig-name descname"><span class="pre">smooth_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hanning'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.preproc.smooth_window" title="Link to this definition">¶</a></dt>
<dd><p>smooth the data using a window with requested size.</p>
<p>This method is based on the convolution of a scaled window with the signal.
The signal is prepared by introducing reflected copies of the signal
(with the window size) in both ends so that transient parts are minimized
in the begining and end part of the output signal.</p>
<p>adapted from SciPy Cookbook: <a class="reference external" href="https://scipy-cookbook.readthedocs.io/items/SignalSmooth.html">https://scipy-cookbook.readthedocs.io/items/SignalSmooth.html</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>the input signal</em>)</p></li>
<li><p><strong>window_len</strong> (<em>the dimension</em><em> of </em><em>the smoothing window; should be an odd integer</em>)</p></li>
<li><p><strong>window</strong> (<em>the type</em><em> of </em><em>window from 'flat'</em><em>, </em><em>'hanning'</em><em>, </em><em>'hamming'</em><em>, </em><em>'bartlett'</em><em>, </em><em>'blackman'</em>) – flat window will produce a moving average smoothing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>np.array</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>the smoothed signal</p>
</dd>
</dl>
</dd></dl>

<section id="fakedata-py">
<span id="module-pypillometry.fakedata"></span><h2>fakedata.py<a class="headerlink" href="#fakedata-py" title="Link to this heading">¶</a></h2>
<p>Generate artificial pupil-data.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.fakedata.generate_pupil_data">
<span class="sig-prename descclassname"><span class="pre">pypillometry.fakedata.</span></span><span class="sig-name descname"><span class="pre">generate_pupil_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event_onsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_lowpass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_signal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_evoked</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.2,</span> <span class="pre">0.05)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evoked_response_perc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response_fluct_sd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prf_npar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10.35,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prf_tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(917.0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_spurious_events</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_amp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.fakedata.generate_pupil_data" title="Link to this definition">¶</a></dt>
<dd><p>Generate artificial pupil data as a sum of slow baseline-fluctuations
on which event-evoked responses are “riding”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event_onsets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – list of all events that evoke a response (in seconds)</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling rate in Hz</p></li>
<li><p><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – append <cite>pad</cite> milliseconds of signal after the last event is decayed</p></li>
<li><p><strong>baseline_lowpass</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – cutoff for the lowpass-filter that defines the baseline
(highest allowed frequency in the baseline fluctuations)</p></li>
<li><p><strong>scale_signal</strong> (<em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>)</em>) – scale of the final signal (mean and SD); default is (0,1), i.e.,
Z-scored data</p></li>
<li><p><strong>scale_evoked</strong> (<em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>)</em>) – amplitude of the pupil-response (mean and SD) in Z-score units;
responses&lt;0 will be set to zero (truncated)</p></li>
<li><p><strong>prf_npar</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>)</em>) – (mean,std) of the npar parameter from <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.pupil.pupil_kernel()</span></code></a>.
If the std is exactly zero, then the mean is used for all pupil-responses.
If the std is positive, npar is taken i.i.d. from ~ normal(mean,std) for each event.</p></li>
<li><p><strong>prf_tmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>)</em>) – (mean,std) of the tmax parameter from <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.pupil.pupil_kernel()</span></code></a>.
If the std is exactly zero, then the mean is used for all pupil-responses.
If the std is positive, tmax is taken i.i.d. from ~ normal(mean,std) for each event.</p></li>
<li><p><strong>num_spurious_events</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Add random events to the pupil signal. These are placed at random locations
throughout the dataset.</p></li>
<li><p><strong>noise_amp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Amplitude of random gaussian noise that sits on top of the simulated signal.
Expressed in SD-units before scaling up the signal</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li></li>
<li><p><strong>tx, sy</strong> (<em>np.array</em>) – time and simulated pupil-dilation (n)</p></li>
<li><p><strong>x0</strong> (<em>np.array</em>) – baseline (n)</p></li>
<li><p><strong>delta_weights</strong> (<em>np.array</em>) – pupil-response strengths (len(event_onsets))</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.fakedata.get_dataset">
<span class="sig-prename descclassname"><span class="pre">pypillometry.fakedata.</span></span><span class="sig-name descname"><span class="pre">get_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ntrials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtdist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1000,</span> <span class="pre">500)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.fakedata.get_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Convenience function to run <a class="reference internal" href="#pypillometry.fakedata.generate_pupil_data" title="pypillometry.fakedata.generate_pupil_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_pupil_data()</span></code></a> with standard parameters.
:type ntrials: 
:param ntrials: number of trials
:type ntrials: int
:type isi: 
:param isi: inter-stimulus interval in milliseconds
:type isi: float
:type rtdist: 
:param rtdist: mean and std of a (truncated at zero) normal distribution to generate response times
:type rtdist: tuple (float,float)
:type fs: 
:param fs: sampling rate
:type fs: float
:type pad: 
:param pad: padding before the first and after the last event in seconds
:type pad: float
:type kwargs: 
:param kwargs: arguments for <a class="reference internal" href="#pypillometry.fakedata.generate_pupil_data" title="pypillometry.fakedata.generate_pupil_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.fakedata.generate_pupil_data()</span></code></a>
:type kwargs: dict</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li></li>
<li><p><strong>tx, sy</strong> (<em>np.array</em>) – time and simulated pupil-dilation (n)</p></li>
<li><p><strong>baseline</strong> (<em>np.array</em>) – baseline (n)</p></li>
<li><p><strong>event_onsets</strong> (<em>np.array</em>) – timing of the simulated event-onsets (stimuli and responses not separated)</p></li>
<li><p><strong>response_coef</strong> (<em>np.array</em>) – pupil-response strengths (len(event_onsets))</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<section id="baseline-py">
<span id="module-pypillometry.baseline"></span><h2>baseline.py<a class="headerlink" href="#baseline-py" title="Link to this heading">¶</a></h2>
<p>Functions for estimating tonic pupillary fluctuations (baseline).</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.baseline.baseline_envelope">
<span class="sig-prename descclassname"><span class="pre">pypillometry.baseline.</span></span><span class="sig-name descname"><span class="pre">baseline_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_onsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prominence_thr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cubic'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.baseline.baseline_envelope" title="Link to this definition">¶</a></dt>
<dd><p>Extract baseline based on the lower envelope of the (filtered) signal.</p>
<p>Steps:</p>
<ul class="simple">
<li><p>filter away noise</p></li>
<li><p>detect high-prominence throughs in the signal</p></li>
<li><p>calculate lower envelope based on these peaks</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> (<em>np.ndarray</em>) – time-vector in seconds</p></li>
<li><p><strong>sy</strong> (<em>np.ndarray</em>) – raw pupil signal</p></li>
<li><p><strong>event_onsets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – onsets of events (stimuli/responses) in seconds</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling rate in Hz</p></li>
<li><p><strong>lp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – low-pass filter cutoff for removing random noise</p></li>
<li><p><strong>prominence_thr</strong> (<em>float in</em><em> [</em><em>0</em><em>,</em><em>100</em><em>]</em>) – percentile of the prominence distribution (of the peaks) to
use for determining prominent peaks (see <cite>scipy.stats.peak_prominences()</cite>)</p></li>
<li><p><strong>interp_method</strong> (<em>string</em><em>, </em><em>one</em><em> of </em><em>[</em><em>&quot;linear&quot;</em><em>, </em><em>&quot;cubic&quot;</em><em>, </em><em>&quot;spline&quot;</em><em>]</em>) – <p>“linear” - linear interpolation between the high-prominence peaks
“cubic”  - cubic interpolation through all high-prominence peaks
“spline” - a smoothing spline that is guaranteed to go through all</p>
<blockquote>
<div><p>high-prominence peaks and smoothes through all the other
(lower-prominence) peaks</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li></li>
<li><p><strong>base</strong> (<em>np.array</em>) – baseline estimate</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.baseline.baseline_envelope_iter_bspline">
<span class="sig-prename descclassname"><span class="pre">pypillometry.baseline.</span></span><span class="sig-name descname"><span class="pre">baseline_envelope_iter_bspline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_onsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam_sig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.baseline.baseline_envelope_iter_bspline" title="Link to this definition">¶</a></dt>
<dd><p>Extract baseline based (re-)estimating the lower envelope using B-splines.
See notebook <cite>baseline_interp.ipynb</cite> for details.
The signal is downsampled (to <cite>fsd</cite> Hz) for speed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> (<em>np.ndarray</em>) – time-vector in seconds</p></li>
<li><p><strong>sy</strong> (<em>np.ndarray</em>) – raw pupil signal</p></li>
<li><p><strong>event_onsets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – onsets of events (stimuli/responses) in milliseconds</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling rate in Hz</p></li>
<li><p><strong>fsd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – downsampled sampling rate (if too slow, decrease)</p></li>
<li><p><strong>lp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – lowpass-filter cutoff (Hz)</p></li>
<li><p><strong>lam_sig</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – parameter steering how much the baseline is shaped by the non-peaks of the signal</p></li>
<li><p><strong>lam_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – parameters mapping how much low- and high-prominence peaks influence the baseline</p></li>
<li><p><strong>lam_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – parameters mapping how much low- and high-prominence peaks influence the baseline</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> [</em><em>0</em><em>, </em><em>100</em><em>]</em>) – how much information to print (0 nothing, 100 everything)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li></li>
<li><p><strong>(txd,syd,base2,base1)</strong> (<em>tuple</em>) – txd: downsampled time-array
syd: downsampled and lowpass-filtered pupil signal
base1: is the estimated base after the first round
base2: is the final baseline estimate</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.baseline.baseline_pupil_model">
<span class="sig-prename descclassname"><span class="pre">pypillometry.baseline.</span></span><span class="sig-name descname"><span class="pre">baseline_pupil_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_onsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lp1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lp2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.baseline.baseline_pupil_model" title="Link to this definition">¶</a></dt>
<dd><p>Extract baseline based on filtering after removing stim-locked activity.</p>
<p>Steps:</p>
<ul class="simple">
<li><p>filter away noise</p></li>
<li><p>regress out event-locked activity from the filtered signal using NNLS</p></li>
<li><p>remove modeled signal from filtered data</p></li>
<li><p>run another lowpass-filter to get rid of spurious signals</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> (<em>np.ndarray</em>) – time-vector in seconds</p></li>
<li><p><strong>sy</strong> (<em>np.ndarray</em>) – raw pupil signal</p></li>
<li><p><strong>event_onsets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – onsets of events (stimuli/responses) in seconds</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling rate in Hz</p></li>
<li><p><strong>lp1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – low-pass filter cutoff for removing random noise</p></li>
<li><p><strong>lp2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – low-pass filter cutoff for removing spurious peaks from the baseline-signal</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li></li>
<li><p><strong>base</strong> (<em>np.array</em>) – baseline estimate</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.baseline.bspline">
<span class="sig-prename descclassname"><span class="pre">pypillometry.baseline.</span></span><span class="sig-name descname"><span class="pre">bspline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">txd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spline_degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.baseline.bspline" title="Link to this definition">¶</a></dt>
<dd><p>Re-implementation from <a class="reference external" href="https://mc-stan.org/users/documentation/case-studies/splines_in_stan.html">https://mc-stan.org/users/documentation/case-studies/splines_in_stan.html</a>.
Similar behaviour as R’s bs() function from the splines-library.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>txd</strong> (<em>np.array</em>) – time-vector</p></li>
<li><p><strong>knots</strong> (<em>np.array</em>) – location of the knots</p></li>
<li><p><strong>spline_degree</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – degree of the spline</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li></li>
<li><p><strong>B</strong> (<em>np.array</em>) – matrix of basis functions</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.baseline.butter_lowpass">
<span class="sig-prename descclassname"><span class="pre">pypillometry.baseline.</span></span><span class="sig-name descname"><span class="pre">butter_lowpass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.baseline.butter_lowpass" title="Link to this definition">¶</a></dt>
<dd><p>Get lowpass-filter coefficients for Butterworth-filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – lowpass-filter cutoff</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling rate</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – filter order</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li></li>
<li><p><strong>(b,a)</strong> (<em>tuple (float,float)</em>) – filter coefficients</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.baseline.butter_lowpass_filter">
<span class="sig-prename descclassname"><span class="pre">pypillometry.baseline.</span></span><span class="sig-name descname"><span class="pre">butter_lowpass_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.baseline.butter_lowpass_filter" title="Link to this definition">¶</a></dt>
<dd><p>Lowpass-filter signal using a Butterworth-filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.array</em>) – data to lowpass-filter</p></li>
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – lowpass-filter cutoff</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling rate</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – filter order</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li></li>
<li><p><strong>y</strong> (<em>np.array</em>) – filtered data</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.baseline.downsample">
<span class="sig-prename descclassname"><span class="pre">pypillometry.baseline.</span></span><span class="sig-name descname"><span class="pre">downsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.baseline.downsample" title="Link to this definition">¶</a></dt>
<dd><p>Simple downsampling scheme using mean within the downsampling window.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>np.array</em>) – signal to downsample</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – decimate-factor</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li></li>
<li><p><strong>y</strong> (<em>np.array</em>) – downsampled data</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<section id="pupil-py">
<span id="module-pypillometry.pupil"></span><h2>pupil.py<a class="headerlink" href="#pupil-py" title="Link to this heading">¶</a></h2>
<p>functions related to pupillary responses.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.pupil.plot_prf">
<span class="sig-prename descclassname"><span class="pre">pypillometry.pupil.</span></span><span class="sig-name descname"><span class="pre">plot_prf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">930</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupil.plot_prf" title="Link to this definition">¶</a></dt>
<dd><p>Plot profile of the pupil-response function (PRF) with
parameters <cite>npar</cite> and <cite>tmax</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.pupil.pupil_build_design_matrix">
<span class="sig-prename descclassname"><span class="pre">pypillometry.pupil.</span></span><span class="sig-name descname"><span class="pre">pupil_build_design_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_onsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupil.pupil_build_design_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Construct design matrix (nevents x n).
Each column has a single pupil-kernel with parameters <cite>npar</cite>, <cite>tmax</cite> starting at
each <cite>event_onset</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> (<em>np.array</em>) – in ms</p></li>
<li><p><strong>event_onsets</strong> (<em>np.array</em>) – timing of the events</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling rate (Hz)</p></li>
<li><p><strong>npar</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – n in the equation of <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.pupil.pupil_kernel()</span></code></a></p></li>
<li><p><strong>tmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – t_{max} in <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.pupil.pupil_kernel()</span></code></a></p></li>
<li><p><strong>max_duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>&quot;estimate&quot;</em>) – either maximum duration in milliseconds or string “estimate” which
causes the function to determine an appropriate duration based on the
kernel parameters <cite>npar</cite> and <cite>tmax</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x1</strong> – design matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array (nevents x n)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.pupil.pupil_get_max_duration">
<span class="sig-prename descclassname"><span class="pre">pypillometry.pupil.</span></span><span class="sig-name descname"><span class="pre">pupil_get_max_duration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupil.pupil_get_max_duration" title="Link to this definition">¶</a></dt>
<dd><p>Get the time when the PRF with parameters <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(t_{max}\)</span> is decayed to
<cite>thr</cite>. This gives an indication of how long the <cite>duration</cite> parameter
in <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pupil_kernel()</span></code></a> should be chosen.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>npar</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – PRF parameters, see <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pupil_kernel()</span></code></a></p></li>
<li><p><strong>tmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – PRF parameters, see <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pupil_kernel()</span></code></a></p></li>
<li><p><strong>thr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – desired value to which the PRF is decayed (the lower <cite>thr</cite>, the longer the duration)</p></li>
<li><p><strong>stepsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – precision of the maximum duration in ms</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tdur</strong> – first value of t so that PRF(t)&lt;<cite>thr</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.pupil.pupil_kernel">
<span class="sig-prename descclassname"><span class="pre">pypillometry.pupil.</span></span><span class="sig-name descname"><span class="pre">pupil_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">930.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupil.pupil_kernel" title="Link to this definition">¶</a></dt>
<dd><p>According to Hoeks and Levelt (1993,
<a class="reference external" href="https://link.springer.com/content/pdf/10.3758%2FBF03204445.pdf">https://link.springer.com/content/pdf/10.3758%2FBF03204445.pdf</a>),
the PRF can be described by the so-called Erlang gamma function
<div class="math notranslate nohighlight">
\[h_{HL}(t) = t^n e^{-nt/t_{max}}\]</div>

which we normalize to
<div class="math notranslate nohighlight">
\[h(t)=\frac{1}{h_{max}} h_{HL}(t)\]</div>

where <div class="math notranslate nohighlight">
\[h_{max} = \max_t{\left(h_{HL}(t)\right)} = e^{-n}t_{max}^{n}\]</div>

which yields a maximum value of 1 for this function.
The function <span class="math notranslate nohighlight">\(h(t)\)</span> is implemented in <cite>pp.pupil_kernel()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – in ms; maximum of the time window for which to calculate the PRF [0,duration]</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling rate for resolving the PRF</p></li>
<li><p><strong>npar</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – n in the equation above</p></li>
<li><p><strong>tmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – t_{max} in the equation above</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li></li>
<li><p><strong>h</strong> (<em>np.array</em>) – sampled version of h(t) over the interval [0,`duration`] with sampling rate <cite>fs</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.pupil.pupil_kernel_t">
<span class="sig-prename descclassname"><span class="pre">pypillometry.pupil.</span></span><span class="sig-name descname"><span class="pre">pupil_kernel_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupil.pupil_kernel_t" title="Link to this definition">¶</a></dt>
<dd><p>According to Hoeks and Levelt (1993,
<a class="reference external" href="https://link.springer.com/content/pdf/10.3758%2FBF03204445.pdf">https://link.springer.com/content/pdf/10.3758%2FBF03204445.pdf</a>),
the PRF can be described by the so-called Erlang gamma function
<div class="math notranslate nohighlight">
\[h_{HL}(t) = t^n e^{-nt/t_{max}}\]</div>

which we normalize to
<div class="math notranslate nohighlight">
\[h(t)=\frac{1}{h_{max}} h_{HL}(t)\]</div>

where <div class="math notranslate nohighlight">
\[h_{max} = \max_t{\left(h_{HL}(t)\right)} = e^{-n}t_{max}^{n}\]</div>

which yields a maximum value of 1 for this function.
The function <span class="math notranslate nohighlight">\(h(t)\)</span> is implemented in <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pupil_kernel()</span></code></a>.</p>
<p>This version of the function evaluates the PRF at inputs <cite>t</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float/np.array</em>) – in ms</p></li>
<li><p><strong>npar</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – n in the equation above</p></li>
<li><p><strong>tmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – t_{max} in the equation above</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>h</strong> – PRF evaluated at <cite>t</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.pupil.pupil_response">
<span class="sig-prename descclassname"><span class="pre">pypillometry.pupil.</span></span><span class="sig-name descname"><span class="pre">pupil_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_onsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'free'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'free'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'npar':</span> <span class="pre">(1,</span> <span class="pre">20),</span> <span class="pre">'tmax':</span> <span class="pre">(100,</span> <span class="pre">2000)}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupil.pupil_response" title="Link to this definition">¶</a></dt>
<dd><p>Estimate pupil-response based on event-onsets.</p>
<dl class="simple">
<dt>tx<span class="classifier">np.ndarray</span></dt><dd><p>time-vector in milliseconds</p>
</dd>
<dt>sy<span class="classifier">np.ndarray</span></dt><dd><p>(baseline-corrected) pupil signal</p>
</dd>
<dt>event_onsets<span class="classifier">list</span></dt><dd><p>onsets of events (stimuli/responses) in milliseconds</p>
</dd>
<dt>fs<span class="classifier">float</span></dt><dd><p>sampling rate in Hz</p>
</dd>
<dt>npar: float</dt><dd><p>npar-parameter for the canonical response-function or “free”;
in case of “free”, the function optimizes for this parameter</p>
</dd>
<dt>tmax: float</dt><dd><p>tmax-parameter for the canonical response-function or “free”;
in case of “free”, the function optimizes for this parameter</p>
</dd>
<dt>bounds: dict</dt><dd><p>in case that one or both parameters are estimated, give the lower
and upper bounds for the parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.pupil.pupilresponse_nnls">
<span class="sig-prename descclassname"><span class="pre">pypillometry.pupil.</span></span><span class="sig-name descname"><span class="pre">pupilresponse_nnls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_onsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">930</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupil.pupilresponse_nnls" title="Link to this definition">¶</a></dt>
<dd><p>Estimate single-event pupil responses based on canonical PRF (<cite>pupil_kernel()</cite>)
using non-negative least-squares (NNLS).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> (<em>np.ndarray</em>) – time-vector in milliseconds</p></li>
<li><p><strong>sy</strong> (<em>np.ndarray</em>) – (baseline-corrected) pupil signal</p></li>
<li><p><strong>event_onsets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – onsets of events (stimuli/responses) in seconds</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – sampling rate in Hz</p></li>
<li><p><strong>npar</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – parameters for <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.pupil.pupil_kernel()</span></code></a></p></li>
<li><p><strong>tmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – parameters for <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.pupil.pupil_kernel()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li></li>
<li><p><strong>(coef,pred,resid)</strong> (<em>tuple</em>) – coef: purely-positive regression coefficients
pred: predicted signal
resid: residuals (sy-pred)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.pupil.stat_event_interval">
<span class="sig-prename descclassname"><span class="pre">pypillometry.pupil.</span></span><span class="sig-name descname"><span class="pre">stat_event_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_onsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statfct=&lt;function</span> <span class="pre">mean&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupil.stat_event_interval" title="Link to this definition">¶</a></dt>
<dd><p>Return result of applying a statistical function to pupillometric data in a
given interval relative to event-onsets. For example, extract mean
pupil-size in interval before trial onset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> (<em>np.ndarray</em>) – time-vector in milliseconds</p></li>
<li><p><strong>sy</strong> (<em>np.ndarray</em>) – (baseline-corrected) pupil signal</p></li>
<li><p><strong>event_onsets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – onsets of events (stimuli/responses) in seconds</p></li>
<li><p><strong>interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> (</em><em>min</em><em>,</em><em>max</em><em>)</em>) – time-window in ms relative to event-onset (0 is event-onset)</p></li>
<li><p><strong>statfct</strong> (<em>function</em>) – function mapping np.array to a single number</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li></li>
<li><p><strong>result</strong> (<em>np.array</em>) – number of event-onsets long result array</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<section id="convenience-py">
<span id="module-pypillometry.convenience"></span><h2>convenience.py<a class="headerlink" href="#convenience-py" title="Link to this heading">¶</a></h2>
<p>Some convenience functions.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.convenience.p_asym_laplac">
<span class="sig-prename descclassname"><span class="pre">pypillometry.convenience.</span></span><span class="sig-name descname"><span class="pre">p_asym_laplac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.convenience.p_asym_laplac" title="Link to this definition">¶</a></dt>
<dd><p>Asymmetric laplace distribution <a class="reference external" href="https://en.wikipedia.org/wiki/Asymmetric_Laplace_distribution">https://en.wikipedia.org/wiki/Asymmetric_Laplace_distribution</a>;
Parametrization as here: <a class="reference external" href="https://github.com/stan-dev/stan/issues/2312">https://github.com/stan-dev/stan/issues/2312</a></p>
<p>tau in [0,1]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.convenience.p_asym_laplac_kappa">
<span class="sig-prename descclassname"><span class="pre">pypillometry.convenience.</span></span><span class="sig-name descname"><span class="pre">p_asym_laplac_kappa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.convenience.p_asym_laplac_kappa" title="Link to this definition">¶</a></dt>
<dd><p>Asymmetric laplace distribution <a class="reference external" href="https://en.wikipedia.org/wiki/Asymmetric_Laplace_distribution">https://en.wikipedia.org/wiki/Asymmetric_Laplace_distribution</a>;
Wikipedia parametrization.</p>
<p>kappa in [0, infty] where 1 means symmetry</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.convenience.plot_pupil_ipy">
<span class="sig-prename descclassname"><span class="pre">pypillometry.convenience.</span></span><span class="sig-name descname"><span class="pre">plot_pupil_ipy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_onsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blinks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(16,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ms'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.convenience.plot_pupil_ipy" title="Link to this definition">¶</a></dt>
<dd><p>Plotting with interactive adjustment of plotting window.
To use this, do</p>
<p>$ pip install ipywidgets
$ jupyter nbextension enable –py widgetsnbextension
$ jupyter labextension install &#64;jupyter-widgets/jupyterlab-manager</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> (<em>np.ndarray</em>) – time-vector in seconds</p></li>
<li><p><strong>sy</strong> (<em>np.ndarray</em>) – raw pupil signal</p></li>
<li><p><strong>event_onsets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – onsets of events (stimuli/responses) in seconds</p></li>
<li><p><strong>overlays</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> of </em><em>np.array</em>) – signals to overlay over the plot, given as tuple of arrays of same length as <cite>tx</cite></p></li>
<li><p><strong>overlay_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> of </em><em>strings</em>) – labels for the overlays to be displayed in the legend</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – dimensions for the plot</p></li>
<li><p><strong>xlab</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – label for x-axis</p></li>
<li><p><strong>nsteps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of steps for slider</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.convenience.sizeof_fmt">
<span class="sig-prename descclassname"><span class="pre">pypillometry.convenience.</span></span><span class="sig-name descname"><span class="pre">sizeof_fmt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'B'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.convenience.sizeof_fmt" title="Link to this definition">¶</a></dt>
<dd><p>Convert number of bytes in <cite>num</cite> into human-readable string representation.
Taken from <a class="reference external" href="https://stackoverflow.com/a/1094933">https://stackoverflow.com/a/1094933</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pypillometry.convenience.trans_logistic_vec">
<span class="sig-prename descclassname"><span class="pre">pypillometry.convenience.</span></span><span class="sig-name descname"><span class="pre">trans_logistic_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.convenience.trans_logistic_vec" title="Link to this definition">¶</a></dt>
<dd><p>vectorized version of trans_logistic()</p>
<p>goes from [a,b] to [-inf,+inf] and back;
inverse=False: [a,b] -&gt; [-inf, +inf]
inverse=True:  [-inf,+inf] -&gt; [a,b]
if a or b is +/-infty, a logarithmic/exponential transform is used</p>
</dd></dl>

</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Link to this heading">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="../genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="../py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="../search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/pypillometry_logo_200x200.png" alt="Logo of pypillometry"/>
            </a></p>
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">API documentation</a><ul>
<li><a class="reference internal" href="#pupildata-py">pupildata.py</a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.FakePupilData"><code class="docutils literal notranslate"><span class="pre">FakePupilData</span></code></a><ul>
<li><a class="reference internal" href="#pypillometry.pupildata.FakePupilData.__init__"><code class="docutils literal notranslate"><span class="pre">FakePupilData.__init__()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.FakePupilData.plot"><code class="docutils literal notranslate"><span class="pre">FakePupilData.plot()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.FakePupilData.scale"><code class="docutils literal notranslate"><span class="pre">FakePupilData.scale()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.FakePupilData.sub_slice"><code class="docutils literal notranslate"><span class="pre">FakePupilData.sub_slice()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.FakePupilData.unscale"><code class="docutils literal notranslate"><span class="pre">FakePupilData.unscale()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData"><code class="docutils literal notranslate"><span class="pre">PupilData</span></code></a><ul>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.__init__"><code class="docutils literal notranslate"><span class="pre">PupilData.__init__()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.__len__"><code class="docutils literal notranslate"><span class="pre">PupilData.__len__()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.__repr__"><code class="docutils literal notranslate"><span class="pre">PupilData.__repr__()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.__weakref__"><code class="docutils literal notranslate"><span class="pre">PupilData.__weakref__</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.add_to_history"><code class="docutils literal notranslate"><span class="pre">PupilData.add_to_history()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.apply_history"><code class="docutils literal notranslate"><span class="pre">PupilData.apply_history()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.blinks_detect"><code class="docutils literal notranslate"><span class="pre">PupilData.blinks_detect()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.blinks_interp_mahot"><code class="docutils literal notranslate"><span class="pre">PupilData.blinks_interp_mahot()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.blinks_interpolate"><code class="docutils literal notranslate"><span class="pre">PupilData.blinks_interpolate()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.blinks_merge"><code class="docutils literal notranslate"><span class="pre">PupilData.blinks_merge()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.blinks_plot"><code class="docutils literal notranslate"><span class="pre">PupilData.blinks_plot()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.copy"><code class="docutils literal notranslate"><span class="pre">PupilData.copy()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.downsample"><code class="docutils literal notranslate"><span class="pre">PupilData.downsample()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.drop_original"><code class="docutils literal notranslate"><span class="pre">PupilData.drop_original()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.estimate_baseline"><code class="docutils literal notranslate"><span class="pre">PupilData.estimate_baseline()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.estimate_response"><code class="docutils literal notranslate"><span class="pre">PupilData.estimate_response()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.from_file"><code class="docutils literal notranslate"><span class="pre">PupilData.from_file()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.get_erpd"><code class="docutils literal notranslate"><span class="pre">PupilData.get_erpd()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.lowpass_filter"><code class="docutils literal notranslate"><span class="pre">PupilData.lowpass_filter()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.nblinks"><code class="docutils literal notranslate"><span class="pre">PupilData.nblinks()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.nevents"><code class="docutils literal notranslate"><span class="pre">PupilData.nevents()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.plot"><code class="docutils literal notranslate"><span class="pre">PupilData.plot()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.plot_segments"><code class="docutils literal notranslate"><span class="pre">PupilData.plot_segments()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.print_history"><code class="docutils literal notranslate"><span class="pre">PupilData.print_history()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.reset_time"><code class="docutils literal notranslate"><span class="pre">PupilData.reset_time()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.scale"><code class="docutils literal notranslate"><span class="pre">PupilData.scale()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.size_bytes"><code class="docutils literal notranslate"><span class="pre">PupilData.size_bytes()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.smooth_window"><code class="docutils literal notranslate"><span class="pre">PupilData.smooth_window()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.stat_per_event"><code class="docutils literal notranslate"><span class="pre">PupilData.stat_per_event()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.sub_slice"><code class="docutils literal notranslate"><span class="pre">PupilData.sub_slice()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.summary"><code class="docutils literal notranslate"><span class="pre">PupilData.summary()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.unscale"><code class="docutils literal notranslate"><span class="pre">PupilData.unscale()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.PupilData.write_file"><code class="docutils literal notranslate"><span class="pre">PupilData.write_file()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pypillometry.pupildata.create_fake_pupildata"><code class="docutils literal notranslate"><span class="pre">create_fake_pupildata()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.plotpd"><code class="docutils literal notranslate"><span class="pre">plotpd()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupildata.plotpd_ia"><code class="docutils literal notranslate"><span class="pre">plotpd_ia()</span></code></a></li>
<li><a class="reference internal" href="#erpd-py">erpd.py</a></li>
<li><a class="reference internal" href="#pypillometry.erpd.ERPD"><code class="docutils literal notranslate"><span class="pre">ERPD</span></code></a><ul>
<li><a class="reference internal" href="#pypillometry.erpd.ERPD.from_file"><code class="docutils literal notranslate"><span class="pre">ERPD.from_file()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.erpd.ERPD.plot"><code class="docutils literal notranslate"><span class="pre">ERPD.plot()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.erpd.ERPD.summary"><code class="docutils literal notranslate"><span class="pre">ERPD.summary()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.erpd.ERPD.write_file"><code class="docutils literal notranslate"><span class="pre">ERPD.write_file()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pypillometry.erpd.group_erpd"><code class="docutils literal notranslate"><span class="pre">group_erpd()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.erpd.plot_erpds"><code class="docutils literal notranslate"><span class="pre">plot_erpds()</span></code></a></li>
<li><a class="reference internal" href="#io-py">io.py</a></li>
<li><a class="reference internal" href="#pypillometry.io.pd_read_pickle"><code class="docutils literal notranslate"><span class="pre">pd_read_pickle()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.io.pd_write_pickle"><code class="docutils literal notranslate"><span class="pre">pd_write_pickle()</span></code></a></li>
<li><a class="reference internal" href="#preproc-py">preproc.py</a></li>
<li><a class="reference internal" href="#pypillometry.preproc.blink_onsets_mahot"><code class="docutils literal notranslate"><span class="pre">blink_onsets_mahot()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.preproc.detect_blinks_velocity"><code class="docutils literal notranslate"><span class="pre">detect_blinks_velocity()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.preproc.detect_blinks_zero"><code class="docutils literal notranslate"><span class="pre">detect_blinks_zero()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.preproc.smooth_window"><code class="docutils literal notranslate"><span class="pre">smooth_window()</span></code></a></li>
<li><a class="reference internal" href="#fakedata-py">fakedata.py</a></li>
<li><a class="reference internal" href="#pypillometry.fakedata.generate_pupil_data"><code class="docutils literal notranslate"><span class="pre">generate_pupil_data()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.fakedata.get_dataset"><code class="docutils literal notranslate"><span class="pre">get_dataset()</span></code></a></li>
<li><a class="reference internal" href="#baseline-py">baseline.py</a></li>
<li><a class="reference internal" href="#pypillometry.baseline.baseline_envelope"><code class="docutils literal notranslate"><span class="pre">baseline_envelope()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.baseline.baseline_envelope_iter_bspline"><code class="docutils literal notranslate"><span class="pre">baseline_envelope_iter_bspline()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.baseline.baseline_pupil_model"><code class="docutils literal notranslate"><span class="pre">baseline_pupil_model()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.baseline.bspline"><code class="docutils literal notranslate"><span class="pre">bspline()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.baseline.butter_lowpass"><code class="docutils literal notranslate"><span class="pre">butter_lowpass()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.baseline.butter_lowpass_filter"><code class="docutils literal notranslate"><span class="pre">butter_lowpass_filter()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.baseline.downsample"><code class="docutils literal notranslate"><span class="pre">downsample()</span></code></a></li>
<li><a class="reference internal" href="#pupil-py">pupil.py</a></li>
<li><a class="reference internal" href="#pypillometry.pupil.plot_prf"><code class="docutils literal notranslate"><span class="pre">plot_prf()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupil.pupil_build_design_matrix"><code class="docutils literal notranslate"><span class="pre">pupil_build_design_matrix()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupil.pupil_get_max_duration"><code class="docutils literal notranslate"><span class="pre">pupil_get_max_duration()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupil.pupil_kernel"><code class="docutils literal notranslate"><span class="pre">pupil_kernel()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupil.pupil_kernel_t"><code class="docutils literal notranslate"><span class="pre">pupil_kernel_t()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupil.pupil_response"><code class="docutils literal notranslate"><span class="pre">pupil_response()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupil.pupilresponse_nnls"><code class="docutils literal notranslate"><span class="pre">pupilresponse_nnls()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.pupil.stat_event_interval"><code class="docutils literal notranslate"><span class="pre">stat_event_interval()</span></code></a></li>
<li><a class="reference internal" href="#convenience-py">convenience.py</a></li>
<li><a class="reference internal" href="#pypillometry.convenience.p_asym_laplac"><code class="docutils literal notranslate"><span class="pre">p_asym_laplac()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.convenience.p_asym_laplac_kappa"><code class="docutils literal notranslate"><span class="pre">p_asym_laplac_kappa()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.convenience.plot_pupil_ipy"><code class="docutils literal notranslate"><span class="pre">plot_pupil_ipy()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.convenience.sizeof_fmt"><code class="docutils literal notranslate"><span class="pre">sizeof_fmt()</span></code></a></li>
<li><a class="reference internal" href="#pypillometry.convenience.trans_logistic_vec"><code class="docutils literal notranslate"><span class="pre">trans_logistic_vec()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="preproc_example_pavlov.html"
                          title="previous chapter">Example: Preprocessing of a full dataset with multiple subjects</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="dev.html"
                          title="next chapter">Developers</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/docs/api.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dev.html" title="Developers"
             >next</a> |</li>
        <li class="right" >
          <a href="preproc_example_pavlov.html" title="Example: Preprocessing of a full dataset with multiple subjects"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pypillometry  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">API documentation</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2020, Matthias Mittner.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>